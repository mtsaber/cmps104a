GPP   = g++ -g -O0 -Wall -Wextra -std=gnu++14
GRIND = valgrind --leak-check=full --show-reachable=yes

all : oc

oc : main.o string_set.o auxlib.o cppstrtok.o 
	${GPP} main.o string_set.o auxlib.o cppstrtok.o -o oc

%.o : %.cpp
	${GPP} -c $<

ci :
	cid + Makefile auxlib.h auxlib.cpp string_set.h
			 string_set.cpp cppstrtok.h cppstrtok.cpp main.cpp

spotless : clean
	- rm oc *.str *.err *.oc *.out *.o *.deps *.log *.oh

clean :
	- rm auxlib.o string_set.o cppstrtok.o main.o Makefile.deps

test : oc
	${GRIND} oc * * >test1.out 2>test1.err
	${GRIND} oc foo foo foo foo bar bar bar foo qux baz \
	         >test2.out 2>test2.err

# Dependencies.
main.o: main.cpp string_set.h auxlib.h cppstrtok.h
stringset.o: string_set.cpp string_set.h
auxlib.o: auxlib.cpp auxlib.h
cppstrtok.o: cppstrtok.cpp cppstrtok.h
